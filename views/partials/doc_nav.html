{% set usedDoc = usedDoc or doc %}

{% macro render_item(item) -%}
  {% set sub_collection = g.collection(item.collection.pod_path + '/' + item.base) %}
  {% set open = sub_collection.pod_path in usedDoc.pod_path[:-3] %}
  {% if doc == item %}
<li class="current">
          <span>{{_(item.title)}}</span>
  {% else %}
<li>
          <a href="{{item.goto or item.url.path}}"{% if item.goto %} class="external"{% endif %}>{{_(item.title)}}</a>
  {% endif %}
  {% if open and sub_collection.exists %}
        {{ render_children(item, sub_collection.docs(locale=usedDoc.locale)) }}
  {% endif %}
        </li>
{% endmacro %}

{% macro tag(item) -%}
  {{"ol" if item.numbered else "ul"}}
{%- endmacro %}
{% macro render_children(item, docs) -%}
  <{{tag(item)}}>
    {% for child in docs %}
      {{render_item(child)}}
    {% endfor %}
  </{{tag(item)}}>
{%- endmacro %}


<nav class="doc-sidebar">
  <div class="current-header">
    <div class="breadcrumbs">
      <div class="breadcrumb light">Build</div>
      <div class="breadcrumb light">Guides</div>
    </div>
    <h1 class="title">Author/Develop</h1>
  </div>

  <div class="current-sections">
    <amp-accordion>
      <section class="top-level expandable">
        <h5 class="section-name">Styling & Layout</h5>
        <amp-accordion class="section-content">
          <section class="sub-level expandable">
            <h5 class="section-name">Supported CSS</h5>
            <ul>
              <li>Disallowed styles</li>
              <li>Restricted styles</li>
              <li>The custom fonts exception</li>
              <li>Using CSS preprocessors</li>
            </ul>
          </section>
          <section class="sub-level">
            <h5 class="section-name">Layout & Media Queries</h5>
            <div></div>
          </section>
          <section class="sub-level">
            <h5 class="section-name">Placeholders & Fallbacks</h5>
            <div></div>
          </section>
          <section class="sub-level">
            <h5 class="section-name">Art direction with srcset, sizes & heights</h5>
            <div></div>
          </section>
          <section class="sub-level">
            <h5 class="section-name">Custom Fonts</h5>
            <div></div>
          </section>
        </amp-accordion>
      </section>
      <section class="top-level">
        <h5 class="section-name">Include Media & Iframes</h5>
        <div></div>
      </section>
      <section class="top-level">
        <h5 class="section-name">Include Third-Party Content</h5>
        <div></div>
      </section>
      <section class="top-level">
        <h5 class="section-name">Ads on your AMP pages</h5>
        <div></div>
      </section>
    </amp-accordion>
  </div>

  <div class="navigation">
    <div class="previous">
      <div class="navigation-label">
        <div class="title">Tutorials</div>
      </div>
    </div>
    <div class="next">
      <div class="navigation-label">
        <div class="subtitle light">Next Guide</div>
        <div class="title">Debug</div>
      </div>
    </div>
  </div>
</nav>
