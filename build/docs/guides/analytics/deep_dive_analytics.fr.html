<!DOCTYPE html>
<html ⚡>
  <head>
    <meta charset="utf-8">
    <title>AMP Analytics dans le détail</title>
    <link rel="canonical" href="https://www.ampproject.org/docs/guides/analytics/deep_dive_analytics.fr.html">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <meta property="og:description" content="Ce guide propose une analyse détaillée ducomposant amp-analytics,en divisant un exemple de configuration de la balise amp-analytics en quatre catégories prin...">
    <meta name="description" content="Ce guide propose une analyse détaillée ducomposant amp-analytics,en divisant un exemple de configuration de la balise amp-analytics en quatre catégories prin...">
    <link rel="shortcut icon" href="/docs/assets/amp_favicon.png?v=2">

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
    <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
    <script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script>

    <style amp-custom>
    body,blockquote,pre,hr,dl,dd,ol,ul,figure{margin:0;padding:0}html,body{background-color:#fbfafb;font-family:Roboto,verdana,arial,sans-serif;margin:0;overflow-x:hidden;padding:0}body{padding-top:66px}ul li,ol li{color:#333;font-size:16px;font-weight:300;line-height:24px}p{color:#333;font-size:16px;font-weight:300;line-height:24px}.container{box-sizing:border-box;margin:0 auto;max-width:1000px;padding:0 20px}.container.md{max-width:800px}.wrap{background-color:#fff;margin:0 auto}.centered{text-align:center}@media only screen and (max-width: 870px){.centered{text-align:left}}.align-right{text-align:right}.clearfix:after{content:"";display:table;clear:both}.clearfix .left{float:left}.clearfix .right{float:right}.clearfix .fill{overflow:hidden;width:auto}h1,h2,h3,h4,h5{color:#147bc1;font-weight:300;margin-top:1.1em;margin-bottom:0.5em}h1{font-size:43px}h2{font-size:36px}h3{font-size:26px}a{color:#0360B5;text-decoration:none}a:hover{text-decoration:underline}a.button{padding:1em;display:block;background-color:#F5F5F5;text-align:center}blockquote{color:#797c82;border-left:4px solid #f5f5f5;padding-left:15px;font-size:18px;letter-spacing:-1px;font-style:italic}blockquote>:last-child{margin-bottom:0}code{font-size:15px;border:1px solid #f5f5f5;border-radius:3px}code{padding:1px 5px}table{border-collapse:collapse}td,th{border:1px solid #FFFFFF;background:#F7F7F7;padding:0.5rem;text-align:left}td.col-fourty{width:40%}td.col-thirty{width:30%}th{background:#eee}th.col-twenty{width:20%}header{-webkit-box-shadow:rgba(0,0,0,0.15) 1px 1px 14px;-moz-box-shadow:rgba(0,0,0,0.15) 1px 1px 14px;box-shadow:rgba(0,0,0,0.15) 1px 1px 14px;font-size:14px;font-weight:300;transform:translateZ(0);backface-visibility:hidden;background-color:#fff}header .container{padding:0}@media only screen and (max-width: 870px){header .container{padding:0 10px}}header.absolute,header.fixed{-moz-transform:translateY(0%);-o-transform:translateY(0%);-ms-transform:translateY(0%);-webkit-transform:translateY(0%);transform:translateY(0%);-moz-transition:all 0.25s ease;-o-transition:all 0.25s ease;-ms-transition:all 0.25s ease;-webkit-transition:all 0.25s ease;transition:all 0.25s ease;left:0;position:fixed;top:0;width:100%;z-index:1000}header.absolute{position:absolute}header.nav--pinned,header.nav--unpinned,header.nav--top{position:fixed}@media only screen and (max-width: 870px){header.nav--pinned,header.nav--unpinned,header.nav--top{position:relative}}header.nav--pinned,header.nav--unpinned{background:#147bc1}header.nav--top{background-color:transparent}header.hidden{display:block}@media only screen and (max-width: 870px){header.hidden{-moz-transform:translateY(-100%);-o-transform:translateY(-100%);-ms-transform:translateY(-100%);-webkit-transform:translateY(-100%);transform:translateY(-100%)}}header.menu-open{transform:translate(-243px, 0px)}@media only screen and (max-width: 870px){header .wrap{color:transparent}}header .content.mobile-show{padding:0 10px 5px}header .left-nav{-webkit-box-align:center;-moz-box-align:center;box-align:center;-webkit-align-items:center;-moz-align-items:center;-ms-align-items:center;-o-align-items:center;align-items:center;-ms-flex-align:center;display:-webkit-box;display:-moz-box;display:box;display:-webkit-flex;display:-moz-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-moz-box-pack:start;box-pack:start;-webkit-justify-content:flex-start;-moz-justify-content:flex-start;-ms-justify-content:flex-start;-o-justify-content:flex-start;justify-content:flex-start;-ms-flex-pack:start;float:left;font-size:14px;letter-spacing:0.04em;margin-left:0}@media only screen and (max-width: 870px){header .left-nav{-webkit-box-pack:start;-moz-box-pack:start;box-pack:start;-webkit-justify-content:flex-start;-moz-justify-content:flex-start;-ms-justify-content:flex-start;-o-justify-content:flex-start;justify-content:flex-start;-ms-flex-pack:start;flex:1 1 auto;padding:0 0 5px 0;text-align:left;width:auto}}header .left-nav .header-title{background-image:url("/docs/assets/logo-blue.svg");background-position:center left;background-repeat:no-repeat;background-size:40px 40px;color:#147bc1;font-family:Roboto, verdana, arial, sans-serif;margin:10px 0;padding:15px 10px 15px 50px;text-transform:none;white-space:nowrap;width:auto}@media only screen and (max-width: 870px){header .left-nav .header-title{line-height:41px;margin:6px 0;padding:0 0 0 50px;width:auto}}@media only screen and (max-width: 870px){header .clearfix{display:flex;flex-wrap:wrap-reverse}}header .alt{padding:15px 0;text-align:right;display:-webkit-box;display:-moz-box;display:box;display:-webkit-flex;display:-moz-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-moz-box-align:center;box-align:center;-webkit-align-items:center;-moz-align-items:center;-ms-align-items:center;-o-align-items:center;align-items:center;-ms-flex-align:center;-webkit-box-pack:center;-moz-box-pack:center;box-pack:center;-webkit-justify-content:center;-moz-justify-content:center;-ms-justify-content:center;-o-justify-content:center;justify-content:center;-ms-flex-pack:center}header .alt.right{letter-spacing:0.04em;font-size:14px}@media only screen and (max-width: 870px){header .alt.right{float:right;text-align:center;flex:0;padding:0 0 10px;font-size:12px;display:inline-block}}header .tab{color:#147bc1;display:inline-block;padding:10px 15px;text-decoration:none;text-transform:uppercase}@media only screen and (max-width: 870px){header .tab{margin-left:auto;padding:10px 12px}}header .tab.go-button{-webkit-box-shadow:-1px 6px 6px -3px rgba(0,0,0,0.22);-moz-box-shadow:-1px 6px 6px -3px rgba(0,0,0,0.22);box-shadow:-1px 6px 6px -3px rgba(0,0,0,0.22);background-color:#147bc1;border:0;border-radius:4px;color:#fff;font-family:Roboto, verdana, arial, sans-serif;font-size:14px;font-weight:500;padding:10px 20px;margin-left:10px;text-transform:uppercase}@media only screen and (max-width: 870px){header .tab.go-button{margin-right:5px;margin-left:auto;padding:8px 10px}}header .tab.go-button:hover{text-decoration:none}header .tab.hamburger{font-size:50px;line-height:38px;background:none;border:none;margin-top:0;padding-top:0;position:relative;top:4px;display:none}@media only screen and (max-width: 870px){header .tab.desktop{display:none}header .tab.hamburger{display:inline-block}}@media only screen and (max-width: 320px){header .header-title span{display:none}header .header-title::after{content:"AMP"}}.main{display:-webkit-flex;display:flex;padding-top:40px;padding-bottom:30px}.main h1{margin-top:0}.main h1:before,.main h2:before,.main h3:before,.main h4:before,.main h5:before{display:block;content:" ";margin-top:-106px;height:106px;visibility:hidden}.main .content{flex-grow:1;-webkit-flex-grow:1;transition:all 0.25s ease;transform:translate(0, 0);will-change:transform;word-break:break-word;min-width:0}.main .content.menu-open{transform:translate(-243px, 0)}.main .content ul,.main .content ol{margin-left:40px}.main .content{overflow-wrap:break-word;word-wrap:break-word;-ms-word-break:break-all;word-break:break-all;word-break:break-word;-ms-hyphens:auto;-moz-hyphens:auto;-webkit-hyphens:auto;hyphens:auto}.main amp-img,.main amp-youtube,.main amp-iframe{margin:1em 0}nav{border-right:2px solid #E6E6E6;padding:20px;margin-right:30px;margin-left:-20px;width:200px;flex-shrink:0;-webkit-flex-shrink:0;background:#F7F7F7;margin-top:-40px;margin-bottom:-30px}nav h2{font-size:20px;color:#111;margin-top:0;margin-bottom:10px}nav ul li,nav ol li{margin-bottom:10px;list-style:none}nav ul li ul,nav ul li ol,nav ol li ul,nav ol li ol{padding-left:0;margin-left:20px;margin-bottom:1.2em}nav ul li ul li,nav ul li ol li,nav ol li ul li,nav ol li ol li{margin-bottom:6px;font-size:14px;list-style:square;color:#CECECE}nav ul li ul li.current,nav ul li ol li.current,nav ol li ul li.current,nav ol li ol li.current{color:#222}nav ul li ul li span,nav ul li ol li span,nav ol li ul li span,nav ol li ol li span{font-weight:400;color:#222}nav ul li ul li ul,nav ul li ul li ol,nav ul li ol li ul,nav ul li ol li ol,nav ol li ul li ul,nav ol li ul li ol,nav ol li ol li ul,nav ol li ol li ol{margin-bottom:0;margin-left:0;padding-left:20px;border-top:1px solid #eee;padding-top:3px;padding-bottom:0px}nav ul li ul li ol li,nav ul li ol li ol li,nav ol li ul li ol li,nav ol li ol li ol li{list-style:decimal}@media only screen and (max-width: 870px){.container nav{display:none}amp-sidebar nav{margin-right:0;border-right:none;margin-top:0;padding-left:36px}}pre{overflow:auto;tab-size:2;word-break:normal;line-height:1.4;background:#F7F7F7}pre>code{white-space:pre;word-wrap:initial;display:block}pre>code td{border:0}.highlight .hll{background-color:#ffc}.highlight .c{color:#aaaaaa;font-style:italic}.highlight .err{color:#F00000}.highlight .k{color:#00a}.highlight .cm{color:#aaaaaa;font-style:italic}.highlight .cp{color:#4c8317}.highlight .c1{color:#aaaaaa;font-style:italic}.highlight .cs{color:#0000aa;font-style:italic}.highlight .gd{color:#a00}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#000080;font-weight:bold}.highlight .gi{color:#0a0}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#800080;font-weight:bold}.highlight .gt{color:#a00}.highlight .kc{color:#00a}.highlight .kd{color:#00a}.highlight .kn{color:#00a}.highlight .kp{color:#00a}.highlight .kr{color:#00a}.highlight .kt{color:#0aa}.highlight .m{color:#099}.highlight .s{color:#a50}.highlight .na{color:#1e90ff}.highlight .nb{color:#0aa}.highlight .nc{color:#00aa00;text-decoration:underline}.highlight .no{color:#a00}.highlight .nd{color:#888}.highlight .ni{color:#800000;font-weight:bold}.highlight .nf{color:#0a0}.highlight .nn{color:#00aaaa;text-decoration:underline}.highlight .nt{color:#1e90ff;font-weight:bold}.highlight .nv{color:#a00}.highlight .ow{color:#00a}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#a50}.highlight .sc{color:#a50}.highlight .sd{color:#a50}.highlight .s2{color:#a50}.highlight .se{color:#a50}.highlight .sh{color:#a50}.highlight .si{color:#a50}.highlight .sx{color:#a50}.highlight .sr{color:#099}.highlight .s1{color:#a50}.highlight .ss{color:#00a}.highlight .bp{color:#0aa}.highlight .vc{color:#a00}.highlight .vg{color:#a00}.highlight .vi{color:#a00}.highlight .il{color:#099}.highlight .lineno{-webkit-user-select:none;-moz-user-select:none;-o-user-select:none}.lineno::-moz-selection{background-color:transparent}.lineno::selection{background-color:transparent}footer{padding:40px 0 60px 100px;background-color:#f5f5f5}footer p{margin:0}footer .footer-image{height:25px;width:25px;padding-left:25px;float:right}
    </style>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:200,300,400,500,700">
  </head>

  <body>
    <amp-analytics type="googleanalytics" id="analytics-ga">
    <script type="application/json">
    {
      "vars": {
        "account": "UA-67833617-1"
      },
      "triggers": {
        "trackPageview": {
          "on": "visible",
          "request": "pageview"
        }
      }
    }
    </script>
    </amp-analytics>

    <amp-sidebar id='sidebar' side='right' layout='nodisplay'>
              
        <nav>
          <ul>
            
            

            <li>
            <h2>Premiers pas</h2>

            <ul>
              
              
              
              
              
              
              

                
                

                
                
                <li>
                  <a href="/docs/get_started/about-amp.fr.html">Qu'est-ce qu'AMP ?</a>
                

                

                </li>
                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                
                
                <li>
                  <a href="/docs/get_started/create_page.fr.html">Créer votre première page AMP</a>
                

                

                </li>
                

              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                
                
                <li>
                  <a href="/docs/get_started/technical_overview.fr.html">Accélération de la performance avec AMP</a>
                

                

                </li>
                

              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
            </ul>
            </li>
            
            
            

            <li>
            <h2>Guides</h2>

            <ul>
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                
                
                <li>
                  <a href="/docs/guides/analytics_amp.fr.html">Configuration d'Analytics</a>
                

                
                  <ul>
                  
                  
                  
                  
                  
                  

                    
                    

                    
                    
                    
                    
                    <li>
                      <a href="/docs/guides/analytics/analytics_basics.fr.html">Analytics &#58; les bases</a>
                    </li>
                    
                    
                    
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  

                    
                    

                    
                    
                    
                    
                    <li class="current">
                      <span>AMP Analytics dans le détail</span>
                    </li>
                    
                    
                    
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  

                    
                    

                    
                    
                    
                    
                    <li>
                      <a href="/docs/guides/analytics/use_cases.fr.html">Cas d'utilisation</a>
                    </li>
                    
                    
                    
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  

                    
                    

                    
                    
                    
                  
                  
                  
                  
                  
                  
                  </ul>
                

                </li>
                

              
              
              
              
              
              
            </ul>
            </li>
            
            
            

            <li>
            <h2>Référence</h2>

            <ul>
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
            </ul>
            </li>
            
            
            

            <li>
            <h2>Support</h2>

            <ul>
              
              
              
              
              
              
              
              
              
              
              
              
            </ul>
            </li>
            
            
            
            
          </ul>
        </nav>
        

    </amp-sidebar>

    <header class="fixed">
      <div class="wrap">
        <div class="container">
          <div class="clearfix">
          <div class="left-nav">
              <a href="https://ampproject.org" class="tab header-title">
                <span>Accelerated
                Mobile
                Pages
                Project</span>
              </a>
            </div>
            <div class="right alt">
              <a class="tab desktop" href="/docs/support/faqs.html">
                FAQ
              </a>
              <a class="tab desktop" href="https://amphtml.wordpress.com">
                Blog
              </a>
              <a class="tab desktop" href="https://github.com/ampproject/amphtml">
                GitHub
              </a>
              <a class="tab desktop" href="/docs/get_started/about-amp.html">
                Documentation
              </a>
              <button class="tab hamburger" id="menu-button" on='tap:sidebar.toggle'>&#x2261;</button>
            </div>
          </div>
        </div>
      </div>
    </header>


    <div class="wrap">
      <div class="container main">
        
        <nav>
          <ul>
            
            

            <li>
            <h2>Premiers pas</h2>

            <ul>
              
              
              
              
              
              
              

                
                

                
                
                <li>
                  <a href="/docs/get_started/about-amp.fr.html">Qu'est-ce qu'AMP ?</a>
                

                

                </li>
                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                
                
                <li>
                  <a href="/docs/get_started/create_page.fr.html">Créer votre première page AMP</a>
                

                

                </li>
                

              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                
                
                <li>
                  <a href="/docs/get_started/technical_overview.fr.html">Accélération de la performance avec AMP</a>
                

                

                </li>
                

              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
            </ul>
            </li>
            
            
            

            <li>
            <h2>Guides</h2>

            <ul>
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                

              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              

                
                

                
                
                <li>
                  <a href="/docs/guides/analytics_amp.fr.html">Configuration d'Analytics</a>
                

                
                  <ul>
                  
                  
                  
                  
                  
                  

                    
                    

                    
                    
                    
                    
                    <li>
                      <a href="/docs/guides/analytics/analytics_basics.fr.html">Analytics &#58; les bases</a>
                    </li>
                    
                    
                    
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  

                    
                    

                    
                    
                    
                    
                    <li class="current">
                      <span>AMP Analytics dans le détail</span>
                    </li>
                    
                    
                    
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  

                    
                    

                    
                    
                    
                    
                    <li>
                      <a href="/docs/guides/analytics/use_cases.fr.html">Cas d'utilisation</a>
                    </li>
                    
                    
                    
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  

                    
                    

                    
                    
                    
                  
                  
                  
                  
                  
                  
                  </ul>
                

                </li>
                

              
              
              
              
              
              
            </ul>
            </li>
            
            
            

            <li>
            <h2>Référence</h2>

            <ul>
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
              
            </ul>
            </li>
            
            
            

            <li>
            <h2>Support</h2>

            <ul>
              
              
              
              
              
              
              
              
              
              
              
              
            </ul>
            </li>
            
            
            
            
          </ul>
        </nav>
        

        <div class="content">
          <!-- article -->
          <article class="post">

    <h1 class="post-title">AMP Analytics dans le détail</h1>

	<div class="post-content">
	    <p>Ce guide propose une analyse détaillée du
<a href="/docs/reference/extended/amp-analytics.html">composant amp-analytics</a>,
en divisant un exemple de configuration de la balise <code class="highlighter-rouge">amp-analytics</code> en quatre catégories principales :</p>

<ul id="markdown-toc">
  <li><a href="#o-envoyer-les-donnes-danalyse-lattribut-type" id="markdown-toc-o-envoyer-les-donnes-danalyse-lattribut-type">Où envoyer les données d’analyse : l’attribut type</a></li>
  <li><a href="#charger-une-configuration-distante-lattribut-config" id="markdown-toc-charger-une-configuration-distante-lattribut-config">Charger une configuration distante : l’attribut config</a></li>
  <li><a href="#les-attributs-requests-triggers-et-transport" id="markdown-toc-les-attributs-requests-triggers-et-transport">Les attributs requests, triggers et transport</a>    <ul>
      <li><a href="#quelles-donnes-sont-envoyes-lattribut-requests" id="markdown-toc-quelles-donnes-sont-envoyes-lattribut-requests">Quelles données sont envoyées : l’attribut requests</a>        <ul>
          <li><a href="#ajout-dune-url-de-requte-attribut-extraurlparams" id="markdown-toc-ajout-dune-url-de-requte-attribut-extraurlparams">Ajout d’une URL de requête : Attribut extraUrlParams</a></li>
        </ul>
      </li>
      <li><a href="#lorsque-les-donnes-sont-envoyes-lattribut-triggers" id="markdown-toc-lorsque-les-donnes-sont-envoyes-lattribut-triggers">Lorsque les données sont envoyées : l’attribut triggers</a></li>
      <li><a href="#comment-les-donnes-sont-envoyes-lattribut-transport" id="markdown-toc-comment-les-donnes-sont-envoyes-lattribut-transport">Comment les données sont envoyées : l’attribut transport</a></li>
    </ul>
  </li>
  <li><a href="#ordonnancement-de-la-substitution-des-variables" id="markdown-toc-ordonnancement-de-la-substitution-des-variables">Ordonnancement de la substitution des variables</a></li>
</ul>

<p>Le reste de ce guide utilise cet exemple de configuration
qui effectue le suivi des vues de page et des clics des utilisateurs sur des liens,
et envoie les données d’analyse à un fournisseur tiers,
<a href="https://developers.google.com/analytics/devguides/collection/amp-analytics/">Google Analytics</a>:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;amp-analytics</span> <span class="na">type=</span><span class="s">"googleanalytics"</span> <span class="na">config=</span><span class="s">"https://example.com/analytics.account.config.json"</span><span class="nt">&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"application/json"</span><span class="nt">&gt;</span>
<span class="p">{</span>
  <span class="s2">"requests"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"pageview"</span><span class="err">:</span> <span class="s2">"https://example.com/analytics?url=${canonicalUrl}&amp;title=${title}&amp;acct=${account}"</span><span class="p">,</span>
    <span class="s2">"event"</span><span class="err">:</span> <span class="s2">"https://example.com/analytics?eid=${eventId}&amp;elab=${eventLabel}&amp;acct=${account}"</span>
  <span class="p">},</span>
  <span class="s2">"vars"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"account"</span><span class="err">:</span> <span class="s2">"ABC123"</span>
  <span class="p">},</span>
  <span class="s2">"extraUrlParams"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"cd1"</span><span class="err">:</span> <span class="s2">"AMP"</span>
  <span class="p">},</span>
  <span class="s2">"triggers"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"trackPageview"</span><span class="err">:</span> <span class="p">{</span>
      <span class="s2">"on"</span><span class="err">:</span> <span class="s2">"visible"</span><span class="p">,</span>
      <span class="s2">"request"</span><span class="err">:</span> <span class="s2">"pageview"</span>
    <span class="p">},</span>
    <span class="s2">"trackAnchorClicks"</span><span class="err">:</span> <span class="p">{</span>
      <span class="s2">"on"</span><span class="err">:</span> <span class="s2">"click"</span><span class="p">,</span>
      <span class="s2">"selector"</span><span class="err">:</span> <span class="s2">"a"</span><span class="p">,</span>
      <span class="s2">"request"</span><span class="err">:</span> <span class="s2">"event"</span><span class="p">,</span>
      <span class="s2">"vars"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"eventId"</span><span class="err">:</span> <span class="s2">"42"</span><span class="p">,</span>
        <span class="s2">"eventLabel"</span><span class="err">:</span> <span class="s2">"clicked on a link"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s1">'transport'</span><span class="err">:</span> <span class="p">{</span>
    <span class="s1">'beacon'</span><span class="err">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s1">'xhrpost'</span><span class="err">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s1">'image'</span><span class="err">:</span> <span class="kc">true</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/amp-analytics&gt;</span></code></pre></figure>

<p><strong>Remarque :</strong> Le code illustré ci-dessus est fourni à titre d’exemple pour vous aider à apprendre, mais il ne constitue en rien un exemple réaliste. Si vous travaillez avec des fournisseurs de solutions d’analyse, il est probable que cet exemple n’ait pas de sens ; les configurations du fournisseur simplifieront les choses. Pour obtenir des exemples de configuration de votre fournisseur, consultez sa documentation.</p>

<h2 id="o-envoyer-les-donnes-danalyse-lattribut-type">Où envoyer les données d’analyse : l’attribut type</h2>

<p>AMP est conçu pour prendre en charge deux modèles courants de collecte des données :</p>

<ul>
  <li>L’ingestion par un point d’extrémité appartenant à un éditeur pour les systèmes d’analyse interne</li>
  <li>L’ingestion par un point d’extrémité appartenant à un fournisseur aux fins d’interopérabilité avec la solution du fournisseur
(par exemple, <a href="https://helpx.adobe.com/marketing-cloud/analytics.html">Adobe Analytics</a>, <a href="http://support.chartbeat.com/docs/">Chartbeat</a> ou encore <a href="https://developers.google.com/analytics/devguides/collection/amp-analytics/">Google Analytics</a>)</li>
</ul>

<p>Pour envoyer des données d’analyse à un fournisseur de solutions d’analyse,
incluez l’attribut <code class="highlighter-rouge">type</code> dans la balise <code class="highlighter-rouge">amp-analytics</code>,
et définissez sa valeur sur le fournisseur approprié, tel que défini dans la
<a href="/docs/reference/extended/amp-analytics.html">spécification du composant amp-analytics</a>.</p>

<p>Par exemple, <code class="highlighter-rouge">&lt;amp-analytics type="googleanalytics"&gt;</code> envoie les données d’analyse
au fournisseur de solutions d’analyse tiers Google Analytics.
Pour envoyer les données à un point d’extrémité appartenant à l’éditeur,
il vous suffit de ne pas inclure l’attribut <code class="highlighter-rouge">type</code> ;
les données d’analyse sont envoyées aux points d’extrémité définis pour chaque
<a href="/docs/guides/analytics/deep_dive_analytics.html#what-data-gets-sent-requests-attribute">requête</a>.</p>

<p>Les configurations des fournisseurs de solutions d’analyse constituent
un bon point de départ pour commencer avec le composant <code class="highlighter-rouge">amp-analytics</code>.
Pour en savoir plus, consultez la documentation et
les ressources d’aide de votre fournisseur.
Comme nous l’avons déjà indiqué,
la liste des fournisseurs qui proposent déjà une intégration AMP ainsi que des liens
vers leurs ressources respectives sont disponibles dans la
<a href="/docs/reference/extended/amp-analytics.html">spécification du composant amp-analytics</a>.</p>

<p>Si vous êtes un fournisseur de solutions d’analyse,
découvrez comment
<a href="https://github.com/ampproject/amphtml/blob/master/extensions/amp-analytics/integrating-analytics.md">intégrer votre propre configuration d’analyse dans AMP HTML</a>.</p>

<h2 id="charger-une-configuration-distante-lattribut-config">Charger une configuration distante : l’attribut config</h2>

<p>Il n’est pas nécessaire d’inclure toutes les configurations
de <code class="highlighter-rouge">amp-analytics</code> dans votre page AMP.
En lieu et place, vous pouvez appeler une URL distante
pour tout ou partie des configurations.</p>

<p>Cela vous permet entre autres de faire varier la configuration
en fonction d’une requête spécifique.
Si, en tant qu’éditeur, vous avez le contrôle du fichier distant,
vous pouvez effectuer tout traitement nécessaire côté serveur
pour créer les données de configuration.</p>

<p>Pour charger les configurations distantes, la première étape consiste à
inclure l’attribut config dans la balise <code class="highlighter-rouge">amp-analytics</code> :</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;amp-analytics</span> <span class="na">config=</span><span class="s">"https://example.com/analytics.account.config.json"</span><span class="nt">&gt;</span></code></pre></figure>

<p>L’étape suivante consiste à créer le contenu JSON qui réside dans l’URL distante.
Dans cet exemple simple,
la configuration contenue dans l’objet JSON est juste la valeur de variable due compte d’analyse.</p>

<p>Exemple de contenu dans <code class="highlighter-rouge">https://example.com/analytics.account.config.json</code> :</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">{
  "vars": {
    "account": "UA-XXXXX-Y"  // Replace with your property ID.
  }
}</code></pre></figure>

<p>La dernière étape consiste à vous assurer que ce qui se trouve dans le fichier distant
est inséré à l’endroit approprié dans la configuration de <code class="highlighter-rouge">amp-analytics</code>.
Dans les requêtes <code class="highlighter-rouge">pageview</code> et <code class="highlighter-rouge">event</code> de cet exemple,
la valeur de la variable <code class="highlighter-rouge">account</code> est automatiquement
définie sur la valeur du compte indiqué dans l’URL distante (<code class="highlighter-rouge">"account": "UA-XXXXX-Y"</code>) :</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">"requests": {
  "pageview": "https://example.com/analytics?url=${canonicalUrl}<span class="err">&amp;</span>title=${title}<span class="err">&amp;</span>acct=${account}",
  "event": "https://example.com/analytics?eid=${eventId}<span class="err">&amp;</span>elab=${eventLabel}<span class="err">&amp;</span>acct=${account}"
}</code></pre></figure>

<p><strong>Important :</strong> AMP ne valide pas les usages multiples d’une même variable.
Les valeurs sont renseignées en fonction d’un ordre de préférence de substitution des variables,
et les valeurs indiquées dans les URL distantes sont en première position
(voir <a href="/docs/guides/analytics/deep_dive_analytics.html#variable-substitution-ordering">Ordonnancement de la substitution des variables</a>).</p>

<h2 id="les-attributs-requests-triggers-et-transport">Les attributs requests, triggers et transport</h2>

<p>L’attribut <code class="highlighter-rouge">requests</code> détermine quelles données sont envoyées
(par exemple <code class="highlighter-rouge">pageviews</code> ou <code class="highlighter-rouge">events</code>)
et où ces données sont envoyées (les URL utilisées pour transmettre les données).</p>

<p>L’attribut <code class="highlighter-rouge">triggers</code> indique à quel moment les données d’analyse doivent être envoyées,
par exemple lorsqu’un utilisateur affiche une page ou clique sur un lien.</p>

<p>L’attribut <code class="highlighter-rouge">transport</code> indique comment envoyer une requête,
et plus spécifiquement le protocole.</p>

<p>Lisez la suite pour en savoir plus sur ces configurations.
(Vous pourrez également en apprendre davantage sur ces configurations dans la
<a href="/docs/reference/extended/amp-analytics.html">référence sur amp-analytics</a>.)</p>

<h3 id="quelles-donnes-sont-envoyes-lattribut-requests">Quelles données sont envoyées : l’attribut requests</h3>

<p>La valeur <code class="highlighter-rouge">request-name</code> est utilisée dans la configuration du déclencheur pour déterminer
quelle requête envoyer en réponse à un événement en particulier.
La valeur <code class="highlighter-rouge">request-value</code> est une URL <code class="highlighter-rouge">https</code>.
Ces valeurs peuvent inclure des jetons d’espace réservé
pouvant renvoyer à d’autres requêtes ou variables.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">"requests": {
  "pageview": "https://example.com/analytics?url=${canonicalUrl}<span class="err">&amp;</span>title=${title}<span class="err">&amp;</span>acct=${account}",
  "event": "https://example.com/analytics?eid=${eventId}<span class="err">&amp;</span>elab=${eventLabel}<span class="err">&amp;</span>acct=${account}"
}</code></pre></figure>

<p>Certains fournisseurs de solutions d’analyse (notamment Google Analytics)
ont déjà fourni une configuration,
que vous utilisez via l’attribut <code class="highlighter-rouge">type</code>.
Si vous utilisez un fournisseur de solutions d’analyse,
il se peut que vous n’ayez pas besoin d’inclure l’information <code class="highlighter-rouge">requests</code>.
Reportez-vous à la documentation de votre fournisseur pour savoir
si l’attribut <code class="highlighter-rouge">requests</code> doit être configuré et, le cas échéant, comment le configurer.</p>

<h4 id="ajout-dune-url-de-requte-attribut-extraurlparams">Ajout d’une URL de requête : Attribut extraUrlParams</h4>

<p>L’attribut <a href="https://github.com/ampproject/amphtml/blob/master/extensions/amp-analytics/amp-analytics.md#extra-url-params">extraUrlParams</a>
spécifie des paramètres additionnels à ajouter à la chaîne de requête de l’URL de requête via la convention usuelle « &amp;foo=baz ».</p>

<p>L’exemple <code class="highlighter-rouge">amp-analytics</code> ajoute un paramètre additionnel <code>cd1</code>
à la requête et définit la valeur de ce paramètre sur « AMP » :</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">  "extraUrlParams": {
    "cd1": "AMP"
  }</code></pre></figure>

<h3 id="lorsque-les-donnes-sont-envoyes-lattribut-triggers">Lorsque les données sont envoyées : l’attribut triggers</h3>

<p>L’attribut <code class="highlighter-rouge">triggers</code> indique le moment auquel une requête d’analyse doit être envoyée.
Il contient une paire clé/valeur précisant le nom et la configuration du déclencheur.
Le nom du déclencheur peut être n’importe quelle chaîne composée
de caractères alphanumériques (a-zA-Z0-9).</p>

<p>Par exemple,
le composant <code class="highlighter-rouge">amp-analytics</code> suivant est configuré pour envoyer une requête à
<code class="highlighter-rouge">https://example.com/analytics</code> lorsque le document est chargé pour la première fois
et à chaque fois que l’on clique sur la balise <code class="highlighter-rouge">a</code> :</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">"triggers": {
  "trackPageview": {
    "on": "visible",
    "request": "pageview"
  },
  "trackAnchorClicks": {
    "on": "click",
    "selector": "a",
    "request": "event",
    "vars": {
      "eventId": "42",
      "eventLabel": "clicked on a link"
    }
  }
}</code></pre></figure>

<p>AMP prend en charge les configurations suivantes pour le déclencheur :</p>

<table>
  <thead>
    <tr>
      <th data-th="Trigger Config" class="col-thirty">Configuration du déclencheur</th>
      <th data-th="Description">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td data-th="Trigger Config"><code>on</code> (obligatoire)</td>
      <td data-th="Description">Événement à écouter. Les valeurs valides sont <code>click</code>, <code>scroll</code>, <code>timer</code> et <code>visible</code>.</td>
    </tr>
    <tr>
      <td data-th="Trigger Config"><code>request</code> (obligatoire)</td>
      <td data-th="Description">Nom de la requête à envoyer (tel que spécifié dans les requêtes <a href="/docs/guides/analytics/deep_dive_analytics.html#what-data-gets-sent-requests-attribute"></a>).</td>
    </tr>
    <tr>
      <td data-th="Trigger Config"><code>vars</code></td>
      <td data-th="Description">Objet contenant des paires clé/valeur utilisé pour remplacer la valeur <code>vars</code> dans la configuration de premier niveau ou pour spécifier une valeur <code>vars</code> unique à ce déclencheur (voir également <a href="/docs/guides/analytics/deep_dive_analytics.html#variable-substitution-ordering">Ordonnancement de la substitution des variables</a>).</td>
    </tr>
    <tr>
      <td data-th="Trigger Config"><code>selector</code> (obligatoire lorsque <code>on</code> est défini sur <code>click</code>)</td>
      <td data-th="Description">Sélecteur CSS utilisé pour définir plus précisément les éléments à suivre. Utilisez la valeur <code>*</code> pour suivre tous les éléments. Cette configuration est utilisée conjointement avec le déclencheur <code>click</code>. Découvrez comment utiliser le sélecteur pour <a href="/docs/guides/analytics/use_cases.html#tracking-page-clicks">suivre les clics sur une page</a> et les <a href="/docs/guides/analytics/use_cases.html#tracking-social-interactions">interactions sociales</a>.</td>
    </tr>
    <tr>
      <td data-th="Trigger Config"><code>scrollSpec</code> (obligatoire lorsque <code>on</code> est défini sur <code>scroll</code>)</td>
      <td data-th="Description">Définit les conditions en fonction desquelles l'événement <code>scroll</code> est déclenché lorsque l'on fait défiler la page. Cet objet peut contenir les propriétés <code>verticalBoundaries</code> et <code>horizontalBoundaries</code>. Au moins l'une des deux propriétés est obligatoire pour qu'un événement <code>scroll</code> soit déclenché. Les valeurs de chacune des propriétés doivent être des ensembles de nombres contenant les limites pour lesquelles un événement scroll est généré. Voir cet exemple sur le <a href="/docs/guides/analytics/use_cases.html#tracking-scrolling">suivi du défilement</a>.</td>
    </tr>
    <tr>
      <td data-th="Trigger Config"><code>timerSpec</code> (obligatoire lorsque <code>on</code> est défini sur <code>timer</code>)</td>
      <td data-th="Description">Définit les conditions en fonction desquelles l'événement <code>timer</code> est déclenché. L'événement timer est déclenché immédiatement, puis à un intervalle spécifié. Cette configuration est utilisée conjointement avec le déclencheur <code>timer</code>.</td>
    </tr>
  </tbody>
</table>

<p><strong>Important :</strong> Les déclencheurs d’une configuration dont la priorité est inférieure sont annulés
par les déclencheurs du même nom dont la priorité est supérieure
(voir <a href="/docs/guides/analytics/deep_dive_analytics.html#variable-substitution-ordering">Ordonnancement de la substitution des variables</a>).</p>

<h3 id="comment-les-donnes-sont-envoyes-lattribut-transport">Comment les données sont envoyées : l’attribut transport</h3>

<p>L’attribut <code class="highlighter-rouge">transport</code> indique comment envoyer une requête.
Les trois modes suivants sont activés par défaut :</p>

<table>
  <thead>
    <tr>
      <th data-th="Transport Method" class="col-thirty">Mode de transport</th>
      <th data-th="Description">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td data-th="Transport Method"><code>beacon</code></td>
      <td data-th="Description">Indique qu'il est possible d'utiliser <a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon">navigator.sendBeacon</a> pour transmettre la requête. Cela envoie une requête <code>POST</code> avec des identifiants et une section body vide.</td>
    </tr>
    <tr>
      <td data-th="Transport Method"><code>xhrpost</code></td>
      <td data-th="Description">Indique qu'il est possible d'utiliser <code>XMLHttpRequest</code> pour transmettre la requête. Cela envoie une requête <code>POST</code> avec des identifiants et une section body vide.</td>
    </tr>
    <tr>
      <td data-th="Transport Method"><code>image</code></td>
      <td data-th="Description">Indique que la requête peut être envoyée en générant une balise <code>Image</code>. Cela envoie une requête <code>GET</code>.</td>
    </tr>
  </tbody>
</table>

<p>Un seul mode de transport est utilisé :
celui qui est activé, autorisé, disponible
et dont la priorité est la plus haute.
La priorité est <code class="highlighter-rouge">beacon</code> &gt; <code class="highlighter-rouge">xhrpost</code> &gt; <code class="highlighter-rouge">image</code>.
Si l’user-agent du client ne prend pas en charge un mode,
c’est le mode suivant dans l’ordre de priorité qui est utilisé.</p>

<p>N’incluez l’attribut <code class="highlighter-rouge">transport</code> dans votre configuration
que si vous souhaitez limiter les options de transport.
Vous risquez sinon d’arrêter les requêtes.</p>

<p>Dans l’exemple ci-dessous,
<code class="highlighter-rouge">beacon</code> et <code class="highlighter-rouge">xhrpost</code> sont définis sur false.
Ils ne seront donc pas utilisés même si leur priorité est supérieure à celle du mode <code class="highlighter-rouge">image</code>.
Si l’user-agent du client prend en charge le mode <code class="highlighter-rouge">image</code>,
il sera utilisé. Sinon, aucune requête n’est envoyée.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">'transport': {
  'beacon': false,
  'xhrpost': false,
  'image': true
}</code></pre></figure>

<h2 id="ordonnancement-de-la-substitution-des-variables">Ordonnancement de la substitution des variables</h2>

<p>AMP renseigne les valeurs des variables dans l’ordre de priorité suivant :</p>

<ol>
  <li>Configurations distantes (via <code class="highlighter-rouge">config</code>).</li>
  <li><code class="highlighter-rouge">vars</code> imbriqué dans un déclencheur dans <code class="highlighter-rouge">triggers</code>.</li>
  <li><code class="highlighter-rouge">vars</code> au niveau supérieur imbriqué dans <code class="highlighter-rouge">amp-analytics</code>.</li>
  <li>Valeurs fournies par la plateforme.</li>
</ol>

<p>Dans cet exemple, nous avons une configuration distante,
des variables définies au niveau supérieur dans triggers et des valeurs au niveau de la plateforme :</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;amp-analytics</span> <span class="na">config=</span><span class="s">"http://example.com/config.json"</span><span class="nt">&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"application/json"</span><span class="nt">&gt;</span>
<span class="p">{</span>
  <span class="s2">"requests"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"pageview"</span><span class="err">:</span> <span class="s2">"https://example.com/analytics?url=${canonicalUrl}&amp;title=${title}&amp;acct=${account}&amp;clientId=${clientId(cid-scope)}"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="s2">"vars"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"account"</span><span class="err">:</span> <span class="s2">"ABC123"</span><span class="p">,</span>
    <span class="s2">"title"</span><span class="err">:</span> <span class="s2">"Homepage"</span>
  <span class="p">},</span>
  <span class="s2">"triggers"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"some-event"</span><span class="err">:</span> <span class="p">{</span>
      <span class="s2">"on"</span><span class="err">:</span> <span class="s2">"visible"</span><span class="p">,</span>
      <span class="s2">"request"</span><span class="err">:</span> <span class="s2">"pageview"</span><span class="p">,</span>
      <span class="s2">"vars"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"title"</span><span class="err">:</span> <span class="s2">"My homepage"</span><span class="p">,</span>
        <span class="s2">"clientId"</span><span class="err">:</span> <span class="s2">"my user"</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/amp-analytics&gt;</span></code></pre></figure>

<p>Lorsque le même <code class="highlighter-rouge">var</code> est défini à plusieurs endroits,
l’ordre de priorité de la variable définit sa valeur une fois.
Ainsi, si la configuration distante définit <code class="highlighter-rouge">account</code> sur UA-XXXXX-Y, comme dans l’exemple ci-dessus,
les valeurs des différentes occurrences de vars sont les suivantes :</p>

<table>
  <thead>
    <tr>
      <th data-th="var" class="col-thirty"><code>var</code></th>
      <th data-th="Value">Valeur</th>
      <th data-th="Defined By" class="col-thirty">Défini par</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td data-th="var"><code>canonicalUrl</code></td>
      <td data-th="Value"><code>http://example.com/path/to/the/page</code></td>
      <td data-th="Defined By">Plateforme</td>
    </tr>
    <tr>
      <td data-th="var"><code>title</code></td>
      <td data-th="Value">My homepage</td>
      <td data-th="Defined By">Déclencheur</td>
    </tr>
    <tr>
      <td data-th="var"><code>account</code></td>
      <td data-th="Value"><code>UA-XXXXX-Y</code></td>
      <td data-th="Defined By">Configuration distante</td>
    </tr>
    <tr>
      <td data-th="var"><code>clientId</code></td>
      <td data-th="Value">my user</td>
      <td data-th="Defined By">Déclencheur</td>
    </tr>
  </tbody>
</table>

	</div>

</article>

          <!-- /article -->
        </div>
      </div>
    </div>

    <footer>
      <div class="container">
        <div class="row">
          <div class="twelve columns">
          </div>
        </div>
    </footer>
  </body>
</html>
